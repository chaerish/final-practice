# java-convenience-store-precourse

## 편의점

구매자의 할인혜택과 재고상황을 고려하여 최종결제금액을 계산하고 안내하는 결제시스템

⚠️ 은 예외를 의미한다.

### 0. md 파일에서 프로모션 정보와 프로덕트 정보를 읽어와 객체를 초기화시킨다.

### 1. 환영 인사와 함께 현재 상품들의 재고를 출력한다.

```text
안녕하세요. W편의점입니다.
현재 보유하고 있는 상품입니다.

- 콜라 1,000원 10개 탄산2+1
- 콜라 1,000원 10개
- 사이다 1,000원 8개 탄산2+1
- 사이다 1,000원 7개
- 오렌지주스 1,800원 9개 MD추천상품
- 오렌지주스 1,800원 재고 없음
- 탄산수 1,200원 5개 탄산2+1
- 탄산수 1,200원 재고 없음
- 물 500원 10개
- 비타민워터 1,500원 6개
- 감자칩 1,500원 5개 반짝할인
- 감자칩 1,500원 5개
- 초코바 1,200원 5개 MD추천상품
- 초코바 1,200원 5개
- 에너지바 2,000원 5개
- 정식도시락 6,400원 8개
- 컵라면 1,700원 1개 MD추천상품
- 컵라면 1,700원 10개

```

### 2. 사용자에게 구매할 상품의 정보를 입력받는다.

```text
구매하실 상품명과 수량을 입력해 주세요. (예: [사이다-2],[감자칩-1])
```

📌 **사용자가 잘못된 값을 입력할 경우 "[ERROR]"로 시작하는 에러 메시지를 출력 후 그 부분부터 입력을 다시 받는다.**

- ⚠️구매할 상품명과 수량은 [ ] 로 묶여야 한다.
- ⚠️구매할 상품과 수량 사이에는 - 으로 구분되어야 한다.
- ⚠️상품과 상품, 즉 [] 사이는 구분자 , 로 구분되어야 한다.

```text
[ERROR] 올바르지 않은 형식 으로 입력했습니다. 다시 입력해 주세요.
```

- ⚠️구매할 상품의 이름이 존재하지 않으면 예외처리한다.

```text
[ERROR] 존재하지 않는 상품입니다. 다시 입력해 주세요.
```

### 3. 사용자가 구매한 상품의 재고를 확인한다.

#### 3-1. 상품의 재고가 구매한 재고보다 적으면 다시 2로 돌아간다.

##### 총 재고

프로모션 상품일 경우: 프로모션 재고 + 일반 재고
일반 상품일 경우: 일반 재고

```text
 [ERROR] 재고수량을 초과하여 구매할 수 없습니다. 다시 입력해 주세요.
```

### 3-2. 프로모션 상품이라면, 현재 프로모션 재고에서 혜택을 받을 수 있는지 검사한다.

#### 3-2-1. 구매 갯수 < 프로모션 총 재고

구매자의 혜택: (프로모션 상품의 총 재고) / (buy+get)
(프로모션 상품의 총 재고) = (구매자의 혜택) * (buy+get)

```text
구매자의 혜택: (구매 갯수) / (buy+get)
if(프로모션 상품의 총 재고 % (buy+get) >= buy && 프로모션 재고가 남았다면) 
    -> 추가 혜택 = (프로모션 상품의 총 재고 % (buy+get)) / buy

else(프로모션 재고가 없다면): 일반 재고에서 차감 
🏁 구매 여부 묻기 : 사용자의 대답이 Y 일 경우 차감하고, N일 경우 패스
    -> (프로모션 상품의 총 재고) -= (구매자의 혜택) * (buy+get) 차감
    -> Y일 경우 일반재고 -= 추가 혜택 
```

##### 3-2-2. 구매 갯수 > 프로모션 총 재고

###### if(프로모션 재고가 0이면)

- 일반재고에서 그냥 차감한다.
- 사용자가 받지 못한 혜택 += 사용자의 구매 갯수
- 사용자의 구매 여부를 묻는다.

###### else(프로모션 재고가 남아있으면)

```text
현재 프로모션 재고에서 차감 가능을 계산.
-> 구매자의 혜택: (구매 갯수) / (buy+get)
-> 남은 프로모션에서 제공 가능: (buy+get) * ((프로모션 상품의 총 재고) / (buy+get))
-> 프로모션에서 제공 불가(사용자가 받지 못한 혜택) += 프로모션 총 재고 - 남은 프로모션에서 제공 가능

🏁 구매 여부 묻기 : 사용자의 대답이 Y 일 경우 차감하고, N일 경우 패스
    -> 추가 혜택 = (프로모션 상품의 총 재고 % (buy+get)) / buy
    -> N일 경우: (프로모션 상품의 총 재고) -= (구매자의 혜택) * (buy+get) 차감
    -> Y일 경우: (프로모션 상품의 총 재고) -= (구매자의 혜택) * (buy+get) 차감
        && (일반재고) -= 혜택 X
```

###### 사용자의 구매 여부 묻기 :

```text
현재 %s%d개는 프로모션 할인이 적용되지 않습니다. 그래도 구매 하시겠습니까? (Y/N)
```

%s: 상품명
%d: 프로모션 제공 불가 갯수

### 3-3. 일반 상품일 경우, 일반 재고에서만 차감한다.

#### 3-3-1. 일반 재고 < 구매 갯수

위에서 예외처리

#### 3-3-2. 일반 재고 > 구매 갯수

일반 재고-=구매갯수

### 4. 멤버십 할인을 적용한다.

```text
멤버십 할인을 받으시겠습니까? (Y/N)
```

#### 4-1. Y일 경우

- **프로모션이 적용되지 않은 금액에서 30퍼를 할인해준다.**
- 최고 한도는 8000원이다.
- 멤버십할인 += 멤버십에 의해 추가로 할인된 금액

#### 4-2 N일 경우

- 프로모션 할인만 적용한다.
- 프로모션 할인(행사 할인) = 고객이 받은 증정품의 갯수 * 그 상품의 가격

### 5. 전체 영수증을 출력한다.

##### 구매 상품 내역: 구매한상품명, 수량, 가격

- 증정 상품 내역: 프로모션에 따라 무료로 제공된 증정상품의 목록

##### 금액정보

- 총구매 액: 구매한 상품의 총 수량과 총 금액
- 행사 할인: 프로모션에 의해 할인 된 금액
- 멤버십 할인: 멤버십에 의해 추가로 할인 된 금액
- 내실돈: 최종결제금액

### 6. 다시 구매할 건지 Y,N 으로 입력받는다.

Y: 1부터 반복
N: 프로그램 종료

## 예외 처리 요구사항

### ⚠️ 예외 상황 발생 시 에러 문구를 출력한다.

에러 문구는 [ERROR]로 시작해야 한다.

## 과제 진행 요구 사항

- [x] 기능 구현 전 READ.md에 구현할 기능 목록을 정리해 추가한다.

## 프로그래밍 요구 사항

- [x] 함수의 길이가 15라인을 넘어가지 않도록 구현한다.
- [x] else 예약어를 쓰지 않는다.
- [x] Java Enum 을 적용해서 프로그램을 구현한다.
- [x] 구현한 기능에 대한 단위 테스트를 작성한다. (입출력 제외)
- [x] 인덴트, 들여쓰기 depth 를 3이 넘지 않도록 구현한다.
- [x] 3항 연산자를 쓰지 않는다.

